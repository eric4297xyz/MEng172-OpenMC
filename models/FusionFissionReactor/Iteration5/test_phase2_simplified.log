======================================================================
FUSION-FISSION HYBRID: MANUAL DEPLETION
======================================================================

This simulation properly handles:
  - External D-D fusion source: 2.45 MeV @ 1e14 n/s
  - Fission multiplication in subcritical fuel
  - Accurate reaction rate normalization

Depletion: 1 steps × 90 days = 90 days
======================================================================

Building geometry...
Geometry: Fuel shell (r=50-100 cm) with inner Na coolant
Burnable material: spent UO2 (ID=1)
Initial volume: 3.6652e+06 cm³

Creating D-D fusion point source...

Transport settings:
  Particles per batch: 5,000
  Active batches: 20
  Total active particles: 100,000

Setting up reaction rate tallies...
Tallies created: fission, nu-fission, capture, (n,2n), (n,3n), flux

Loading depletion chain from /workspaces/MEng172-OpenMC/models/FusionFissionReactor/Iteration5/chain_reduced_tru.xml...
Chain loaded: 1760 nuclides

======================================================================
STARTING MANUAL DEPLETION
======================================================================

======================================================================
STEP 1/1: t = 0.0 days
======================================================================

Running transport calculation...
                                %%%%%%%%%%%%%%%
                           %%%%%%%%%%%%%%%%%%%%%%%%
                        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                      %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                                    %%%%%%%%%%%%%%%%%%%%%%%%
                                     %%%%%%%%%%%%%%%%%%%%%%%%
                 ###############      %%%%%%%%%%%%%%%%%%%%%%%%
                ##################     %%%%%%%%%%%%%%%%%%%%%%%
                ###################     %%%%%%%%%%%%%%%%%%%%%%%
                ####################     %%%%%%%%%%%%%%%%%%%%%%
                #####################     %%%%%%%%%%%%%%%%%%%%%
                ######################     %%%%%%%%%%%%%%%%%%%%
                #######################     %%%%%%%%%%%%%%%%%%
                 #######################     %%%%%%%%%%%%%%%%%
                 ######################     %%%%%%%%%%%%%%%%%
                  ####################     %%%%%%%%%%%%%%%%%
                    #################     %%%%%%%%%%%%%%%%%
                     ###############     %%%%%%%%%%%%%%%%
                       ############     %%%%%%%%%%%%%%%
                          ########     %%%%%%%%%%%%%%
                                      %%%%%%%%%%%

                 | The OpenMC Monte Carlo Code
       Copyright | 2011-2025 MIT, UChicago Argonne LLC, and contributors
         License | https://docs.openmc.org/en/latest/license.html
         Version | 0.15.3
     Commit Hash | 27e38e894697bb32a1dac7848d2618818b6b8daf
       Date/Time | 2026-02-01 18:59:42
   MPI Processes | 1
  OpenMP Threads | 4

 Reading model XML file 'model.xml' ...
 WARNING: Other XML file input(s) are present. These files may be ignored in
          favor of the model.xml file.
 Reading cross sections XML file...
 Reading O16 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/O16.h5
 Reading U238 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/U238.h5
 Reading U235 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/U235.h5
 Reading U236 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/U236.h5
 Reading U234 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/U234.h5
 Reading U237 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/U237.h5
 Reading Pu239 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Pu239.h5
 Reading Pu240 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Pu240.h5
 Reading Pu241 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Pu241.h5
 Reading Pu242 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Pu242.h5
 Reading Pu238 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Pu238.h5
 Reading Np237 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Np237.h5
 Reading Am243 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Am243.h5
 Reading Am241 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Am241.h5
 Reading Cm244 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Cm244.h5
 Reading Cm242 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Cm242.h5
 Reading Cm245 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Cm245.h5
 Reading Cm243 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Cm243.h5
 Reading Cm246 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Cm246.h5
 Reading Cs137 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Cs137.h5
 Reading Cs133 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Cs133.h5
 Reading Tc99 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Tc99.h5
 Reading Ru101 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Ru101.h5
 Reading Zr93 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Zr93.h5
 Reading Mo95 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Mo95.h5
 Reading Sr90 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Sr90.h5
 Reading Nd143 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Nd143.h5
 Reading Nd145 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Nd145.h5
 Reading Rh103 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Rh103.h5
 Reading Cs135 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Cs135.h5
 Reading Pd107 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Pd107.h5
 Reading Sm150 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Sm150.h5
 Reading I129 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/I129.h5
 Reading Pm147 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Pm147.h5
 Reading Eu153 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Eu153.h5
 Reading Sm152 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Sm152.h5
 Reading Ag109 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Ag109.h5
 Reading Sm147 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Sm147.h5
 Reading Ru103 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Ru103.h5
 Reading Sn126 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Sn126.h5
 Reading Nb95 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Nb95.h5
 WARNING: Negative value(s) found on probability table for nuclide Nb95 at 294K
 Reading Cl36 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Cl36.h5
 Reading Ca41 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Ca41.h5
 Reading Ni59 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Ni59.h5
 Reading Sm151 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Sm151.h5
 Reading Se79 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Se79.h5
 WARNING: Negative value(s) found on probability table for nuclide Se79 at 294K
 Reading Eu155 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Eu155.h5
 Reading Pr143 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Pr143.h5
 Reading Sm149 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Sm149.h5
 Reading Nd147 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Nd147.h5
 Reading Xe133 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Xe133.h5
 Reading Gd155 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Gd155.h5
 Reading I133 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/I133.h5
 Reading Eu152 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Eu152.h5
 Reading Mo99 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Mo99.h5
 WARNING: Negative value(s) found on probability table for nuclide Mo99 at 294K
 Reading Na23 from /workspaces/MEng172-OpenMC/endfb80-lowtemp/neutron/Na23.h5
 Minimum neutron data temperature: 294 K
 Maximum neutron data temperature: 294 K
 Preparing distributed cell instances...
 Writing summary.h5 file...
 Maximum neutron transport energy: 20000000 eV for Pu239

 ===============>     FIXED SOURCE TRANSPORT SIMULATION     <===============

 Simulating batch 1
 Simulating batch 2
 Simulating batch 3
 Simulating batch 4
 Simulating batch 5
 Simulating batch 6
 Simulating batch 7
 Simulating batch 8
 Simulating batch 9
 Simulating batch 10
 Simulating batch 11
 Simulating batch 12
 Simulating batch 13
 Simulating batch 14
 Simulating batch 15
 Simulating batch 16
 Simulating batch 17
 Simulating batch 18
 Simulating batch 19
 Simulating batch 20
 Simulating batch 21
 Simulating batch 22
 Simulating batch 23
 Simulating batch 24
 Simulating batch 25
 Simulating batch 26
 Simulating batch 27
 Simulating batch 28
 Simulating batch 29
 Simulating batch 30
 Creating state point statepoint.30.h5...

 =======================>     TIMING STATISTICS     <=======================

 Total time for initialization     = 5.8557e+00 seconds
   Reading cross sections          = 5.8452e+00 seconds
 Total time in simulation          = 8.3111e+01 seconds
   Time in transport only          = 8.3049e+01 seconds
   Time in active batches          = 8.3111e+01 seconds
   Time accumulating tallies       = 5.2637e-02 seconds
   Time writing statepoints        = 7.3903e-03 seconds
 Total time for finalization       = 1.8198e-04 seconds
 Total time elapsed                = 8.8982e+01 seconds
 Calculation Rate (active)         = 1804.81 particles/second

 ============================>     RESULTS     <============================

 Leakage Fraction            = 0.07865 +/- 0.00104

Transport complete. Extracting reaction rates...

Reaction rates [per second]:
  Fission:     4.0940e+13 fissions/s
  Nu-fission:  1.1009e+14 neutrons/s (from fission)
  Capture:     1.6016e+14 captures/s
  (n,2n):      3.7295e+11 reactions/s
  Total flux:  2.0938e+16 n·cm/s

  k_source (multiplication): 1.1009
  (Each source neutron produces 1.1009 fission neutrons)

  Fission power: 1.31e+03 W = 1.31 kW = 0.0013 MW

======================================================================
CALCULATING SIMPLIFIED DEPLETION
======================================================================

NOTE: This uses aggregate reaction rates distributed proportionally
Full implementation would require nuclide-specific reaction rate tallies

Current total atoms: 2.614e+29
Time step: 7.78e+06 seconds (90 days)

Top 10 isotope changes:
  O16     : -8.368e+20 atoms (-0.000%)
  U238    : -3.832e+20 atoms (-0.000%)
  U235    : -1.696e+20 atoms (-0.000%)
  Pu239   : -1.247e+20 atoms (-0.000%)
  Pu241   : -3.249e+19 atoms (-0.000%)
  U236    : -2.627e+18 atoms (-0.000%)
  Cs137   : -1.309e+18 atoms (-0.000%)
  Pu240   : -1.272e+18 atoms (-0.000%)
  Cs133   : -1.220e+18 atoms (-0.000%)
  Tc99    : -1.165e+18 atoms (-0.000%)

Updating material composition for next transport step...
Traceback (most recent call last):
  File "/workspaces/MEng172-OpenMC/models/FusionFissionReactor/Iteration5/hybrid_depletion_manual.py", line 316, in <module>
    burnable_mat.remove_nuclide(nuc)
  File "/opt/conda/lib/python3.12/site-packages/openmc/material.py", line 636, in remove_nuclide
    cv.check_type('nuclide', nuclide, str)
  File "/opt/conda/lib/python3.12/site-packages/openmc/checkvalue.py", line 41, in check_type
    raise TypeError(msg)
TypeError: Unable to set "nuclide" to "NuclideTuple(name='O16', percent=0.67187968, percent_type='ao')" which is not of type "<class 'str'>"
